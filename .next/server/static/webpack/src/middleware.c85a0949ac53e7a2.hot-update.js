"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n\n// Simple in-memory rate limiting\n// For production, use Redis or a dedicated rate limiting service\nconst rateLimit = new Map();\nconst WINDOW_MS = parseInt(process.env.RATE_LIMIT_WINDOW_MS || \"60000\"); // 1 minute\nconst MAX_REQUESTS = parseInt(process.env.RATE_LIMIT_MAX || \"20\"); // 20 requests per minute\nfunction middleware(request) {\n    // Only rate limit API routes\n    if (!request.nextUrl.pathname.startsWith(\"/api/\")) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n    }\n    // Get client IP\n    const ip = request.ip ?? request.headers.get(\"x-forwarded-for\") ?? \"anonymous\";\n    const now = Date.now();\n    // Get existing timestamps for this IP\n    const timestamps = rateLimit.get(ip) ?? [];\n    // Filter out timestamps outside the current window\n    const recentRequests = timestamps.filter((time)=>now - time < WINDOW_MS);\n    // Check if rate limit exceeded\n    if (recentRequests.length >= MAX_REQUESTS) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Too many requests. Please try again later.\",\n            retryAfter: Math.ceil(WINDOW_MS / 1000)\n        }, {\n            status: 429,\n            headers: {\n                \"Retry-After\": String(Math.ceil(WINDOW_MS / 1000)),\n                \"X-RateLimit-Limit\": String(MAX_REQUESTS),\n                \"X-RateLimit-Remaining\": \"0\",\n                \"X-RateLimit-Reset\": String(Math.ceil((now + WINDOW_MS) / 1000))\n            }\n        });\n    }\n    // Add current timestamp\n    recentRequests.push(now);\n    rateLimit.set(ip, recentRequests);\n    // Clean up old entries periodically (every 100 requests)\n    if (Math.random() < 0.01) {\n        const cutoff = now - WINDOW_MS;\n        Array.from(rateLimit.entries()).forEach(([key, times])=>{\n            const filtered = times.filter((t)=>t > cutoff);\n            if (filtered.length === 0) {\n                rateLimit.delete(key);\n            } else {\n                rateLimit.set(key, filtered);\n            }\n        });\n    }\n    // Add rate limit headers to response\n    const response = next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n    response.headers.set(\"X-RateLimit-Limit\", String(MAX_REQUESTS));\n    response.headers.set(\"X-RateLimit-Remaining\", String(MAX_REQUESTS - recentRequests.length));\n    response.headers.set(\"X-RateLimit-Reset\", String(Math.ceil((now + WINDOW_MS) / 1000)));\n    return response;\n}\nconst config = {\n    matcher: [\n        \"/api/:path*\",\n        \"/admin/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBRzNDLGlDQUFpQztBQUNqQyxpRUFBaUU7QUFDakUsTUFBTUMsWUFBWSxJQUFJQztBQUV0QixNQUFNQyxZQUFZQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLG9CQUFvQixJQUFJLFVBQVUsV0FBVztBQUNwRixNQUFNQyxlQUFlSixTQUFTQyxRQUFRQyxHQUFHLENBQUNHLGNBQWMsSUFBSSxPQUFPLHlCQUF5QjtBQUVyRixTQUFTQyxXQUFXQyxPQUFvQjtJQUM3Qyw2QkFBNkI7SUFDN0IsSUFBSSxDQUFDQSxRQUFRQyxPQUFPLENBQUNDLFFBQVEsQ0FBQ0MsVUFBVSxDQUFDLFVBQVU7UUFDakQsT0FBT2Qsa0ZBQVlBLENBQUNlLElBQUk7SUFDMUI7SUFFQSxnQkFBZ0I7SUFDaEIsTUFBTUMsS0FBS0wsUUFBUUssRUFBRSxJQUFJTCxRQUFRTSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxzQkFBc0I7SUFDbkUsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUVwQixzQ0FBc0M7SUFDdEMsTUFBTUUsYUFBYXBCLFVBQVVpQixHQUFHLENBQUNGLE9BQU8sRUFBRTtJQUUxQyxtREFBbUQ7SUFDbkQsTUFBTU0saUJBQWlCRCxXQUFXRSxNQUFNLENBQUNDLENBQUFBLE9BQVFMLE1BQU1LLE9BQU9yQjtJQUU5RCwrQkFBK0I7SUFDL0IsSUFBSW1CLGVBQWVHLE1BQU0sSUFBSWpCLGNBQWM7UUFDekMsT0FBT1Isa0ZBQVlBLENBQUMwQixJQUFJLENBQ3RCO1lBQ0VDLE9BQU87WUFDUEMsWUFBWUMsS0FBS0MsSUFBSSxDQUFDM0IsWUFBWTtRQUNwQyxHQUNBO1lBQ0U0QixRQUFRO1lBQ1JkLFNBQVM7Z0JBQ1AsZUFBZWUsT0FBT0gsS0FBS0MsSUFBSSxDQUFDM0IsWUFBWTtnQkFDNUMscUJBQXFCNkIsT0FBT3hCO2dCQUM1Qix5QkFBeUI7Z0JBQ3pCLHFCQUFxQndCLE9BQU9ILEtBQUtDLElBQUksQ0FBQyxDQUFDWCxNQUFNaEIsU0FBUSxJQUFLO1lBQzVEO1FBQ0Y7SUFFSjtJQUVBLHdCQUF3QjtJQUN4Qm1CLGVBQWVXLElBQUksQ0FBQ2Q7SUFDcEJsQixVQUFVaUMsR0FBRyxDQUFDbEIsSUFBSU07SUFFbEIseURBQXlEO0lBQ3pELElBQUlPLEtBQUtNLE1BQU0sS0FBSyxNQUFNO1FBQ3hCLE1BQU1DLFNBQVNqQixNQUFNaEI7UUFDckJrQyxNQUFNQyxJQUFJLENBQUNyQyxVQUFVc0MsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQyxDQUFDQyxLQUFLQyxNQUFNO1lBQ25ELE1BQU1DLFdBQVdELE1BQU1uQixNQUFNLENBQUMsQ0FBQ3FCLElBQWNBLElBQUlSO1lBQ2pELElBQUlPLFNBQVNsQixNQUFNLEtBQUssR0FBRztnQkFDekJ4QixVQUFVNEMsTUFBTSxDQUFDSjtZQUNuQixPQUFPO2dCQUNMeEMsVUFBVWlDLEdBQUcsQ0FBQ08sS0FBS0U7WUFDckI7UUFDRjtJQUNGO0lBRUEscUNBQXFDO0lBQ3JDLE1BQU1HLFdBQVc5QyxrRkFBWUEsQ0FBQ2UsSUFBSTtJQUNsQytCLFNBQVM3QixPQUFPLENBQUNpQixHQUFHLENBQUMscUJBQXFCRixPQUFPeEI7SUFDakRzQyxTQUFTN0IsT0FBTyxDQUFDaUIsR0FBRyxDQUFDLHlCQUF5QkYsT0FBT3hCLGVBQWVjLGVBQWVHLE1BQU07SUFDekZxQixTQUFTN0IsT0FBTyxDQUFDaUIsR0FBRyxDQUFDLHFCQUFxQkYsT0FBT0gsS0FBS0MsSUFBSSxDQUFDLENBQUNYLE1BQU1oQixTQUFRLElBQUs7SUFFL0UsT0FBTzJDO0FBQ1Q7QUFFTyxNQUFNQyxTQUFTO0lBQ3BCQyxTQUFTO1FBQUM7UUFBZTtLQUFnQjtBQUMzQyxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9taWRkbGV3YXJlLnRzP2QxOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5cclxuLy8gU2ltcGxlIGluLW1lbW9yeSByYXRlIGxpbWl0aW5nXHJcbi8vIEZvciBwcm9kdWN0aW9uLCB1c2UgUmVkaXMgb3IgYSBkZWRpY2F0ZWQgcmF0ZSBsaW1pdGluZyBzZXJ2aWNlXHJcbmNvbnN0IHJhdGVMaW1pdCA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXJbXT4oKTtcclxuXHJcbmNvbnN0IFdJTkRPV19NUyA9IHBhcnNlSW50KHByb2Nlc3MuZW52LlJBVEVfTElNSVRfV0lORE9XX01TIHx8ICc2MDAwMCcpOyAvLyAxIG1pbnV0ZVxyXG5jb25zdCBNQVhfUkVRVUVTVFMgPSBwYXJzZUludChwcm9jZXNzLmVudi5SQVRFX0xJTUlUX01BWCB8fCAnMjAnKTsgLy8gMjAgcmVxdWVzdHMgcGVyIG1pbnV0ZVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICAvLyBPbmx5IHJhdGUgbGltaXQgQVBJIHJvdXRlc1xyXG4gIGlmICghcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvJykpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGNsaWVudCBJUFxyXG4gIGNvbnN0IGlwID0gcmVxdWVzdC5pcCA/PyByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKSA/PyAnYW5vbnltb3VzJztcclxuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cclxuICAvLyBHZXQgZXhpc3RpbmcgdGltZXN0YW1wcyBmb3IgdGhpcyBJUFxyXG4gIGNvbnN0IHRpbWVzdGFtcHMgPSByYXRlTGltaXQuZ2V0KGlwKSA/PyBbXTtcclxuXHJcbiAgLy8gRmlsdGVyIG91dCB0aW1lc3RhbXBzIG91dHNpZGUgdGhlIGN1cnJlbnQgd2luZG93XHJcbiAgY29uc3QgcmVjZW50UmVxdWVzdHMgPSB0aW1lc3RhbXBzLmZpbHRlcih0aW1lID0+IG5vdyAtIHRpbWUgPCBXSU5ET1dfTVMpO1xyXG5cclxuICAvLyBDaGVjayBpZiByYXRlIGxpbWl0IGV4Y2VlZGVkXHJcbiAgaWYgKHJlY2VudFJlcXVlc3RzLmxlbmd0aCA+PSBNQVhfUkVRVUVTVFMpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBcclxuICAgICAgICBlcnJvcjogJ1RvbyBtYW55IHJlcXVlc3RzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicsXHJcbiAgICAgICAgcmV0cnlBZnRlcjogTWF0aC5jZWlsKFdJTkRPV19NUyAvIDEwMDApXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgXHJcbiAgICAgICAgc3RhdHVzOiA0MjksXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ1JldHJ5LUFmdGVyJzogU3RyaW5nKE1hdGguY2VpbChXSU5ET1dfTVMgLyAxMDAwKSksXHJcbiAgICAgICAgICAnWC1SYXRlTGltaXQtTGltaXQnOiBTdHJpbmcoTUFYX1JFUVVFU1RTKSxcclxuICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiAnMCcsXHJcbiAgICAgICAgICAnWC1SYXRlTGltaXQtUmVzZXQnOiBTdHJpbmcoTWF0aC5jZWlsKChub3cgKyBXSU5ET1dfTVMpIC8gMTAwMCkpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gQWRkIGN1cnJlbnQgdGltZXN0YW1wXHJcbiAgcmVjZW50UmVxdWVzdHMucHVzaChub3cpO1xyXG4gIHJhdGVMaW1pdC5zZXQoaXAsIHJlY2VudFJlcXVlc3RzKTtcclxuXHJcbiAgLy8gQ2xlYW4gdXAgb2xkIGVudHJpZXMgcGVyaW9kaWNhbGx5IChldmVyeSAxMDAgcmVxdWVzdHMpXHJcbiAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjAxKSB7XHJcbiAgICBjb25zdCBjdXRvZmYgPSBub3cgLSBXSU5ET1dfTVM7XHJcbiAgICBBcnJheS5mcm9tKHJhdGVMaW1pdC5lbnRyaWVzKCkpLmZvckVhY2goKFtrZXksIHRpbWVzXSkgPT4ge1xyXG4gICAgICBjb25zdCBmaWx0ZXJlZCA9IHRpbWVzLmZpbHRlcigodDogbnVtYmVyKSA9PiB0ID4gY3V0b2ZmKTtcclxuICAgICAgaWYgKGZpbHRlcmVkLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJhdGVMaW1pdC5kZWxldGUoa2V5KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByYXRlTGltaXQuc2V0KGtleSwgZmlsdGVyZWQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIEFkZCByYXRlIGxpbWl0IGhlYWRlcnMgdG8gcmVzcG9uc2VcclxuICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5uZXh0KCk7XHJcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtUmF0ZUxpbWl0LUxpbWl0JywgU3RyaW5nKE1BWF9SRVFVRVNUUykpO1xyXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLVJhdGVMaW1pdC1SZW1haW5pbmcnLCBTdHJpbmcoTUFYX1JFUVVFU1RTIC0gcmVjZW50UmVxdWVzdHMubGVuZ3RoKSk7XHJcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtUmF0ZUxpbWl0LVJlc2V0JywgU3RyaW5nKE1hdGguY2VpbCgobm93ICsgV0lORE9XX01TKSAvIDEwMDApKSk7XHJcblxyXG4gIHJldHVybiByZXNwb25zZTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBtYXRjaGVyOiBbJy9hcGkvOnBhdGgqJywgJy9hZG1pbi86cGF0aConXSxcclxufTtcclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJhdGVMaW1pdCIsIk1hcCIsIldJTkRPV19NUyIsInBhcnNlSW50IiwicHJvY2VzcyIsImVudiIsIlJBVEVfTElNSVRfV0lORE9XX01TIiwiTUFYX1JFUVVFU1RTIiwiUkFURV9MSU1JVF9NQVgiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsIm5leHRVcmwiLCJwYXRobmFtZSIsInN0YXJ0c1dpdGgiLCJuZXh0IiwiaXAiLCJoZWFkZXJzIiwiZ2V0Iiwibm93IiwiRGF0ZSIsInRpbWVzdGFtcHMiLCJyZWNlbnRSZXF1ZXN0cyIsImZpbHRlciIsInRpbWUiLCJsZW5ndGgiLCJqc29uIiwiZXJyb3IiLCJyZXRyeUFmdGVyIiwiTWF0aCIsImNlaWwiLCJzdGF0dXMiLCJTdHJpbmciLCJwdXNoIiwic2V0IiwicmFuZG9tIiwiY3V0b2ZmIiwiQXJyYXkiLCJmcm9tIiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ0aW1lcyIsImZpbHRlcmVkIiwidCIsImRlbGV0ZSIsInJlc3BvbnNlIiwiY29uZmlnIiwibWF0Y2hlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});